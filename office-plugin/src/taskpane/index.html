<!DOCTYPE html>
<html lang="zh-CN">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>æ­¦æ±‰é—®æ´¥ AI åŠ©æ‰‹</title>

  <!-- Favicon -->
  <link rel="icon" type="image/png" href="/assets/icon-32.png">

  <!-- Office.js åº“ - ä½¿ç”¨æœ¬åœ°æ–‡ä»¶ -->
  <script src="/libs/office.js" onerror="handleOfficeJsLoadError()"></script>

  <script>
    console.log('ğŸ“„ HTML å·²åŠ è½½')
    console.log('ğŸŒ User Agent:', navigator.userAgent)

    // ç«‹å³æ³¨å†Œ Office.onReadyï¼Œé˜²æ­¢è¶…æ—¶é”™è¯¯
    // è¿™å¿…é¡»åœ¨ Office.js åŠ è½½åç«‹å³æ‰§è¡Œï¼Œä¸èƒ½ç­‰å¾…æ¨¡å—åŠ è½½
    window.__officeReadyPromise = null
    window.__officeInfo = null
    
    if (typeof Office !== 'undefined' && Office.onReady) {
      console.log('ğŸ“Œ ç«‹å³æ³¨å†Œ Office.onReady...')
      window.__officeReadyPromise = Office.onReady(function(info) {
        console.log('âœ… Office.onReady å›è°ƒå·²è§¦å‘', info)
        window.__officeInfo = info
        // è§¦å‘è‡ªå®šä¹‰äº‹ä»¶ï¼Œé€šçŸ¥ React åº”ç”¨
        window.dispatchEvent(new CustomEvent('office-ready', { detail: info }))
      })
    }

    function handleOfficeJsLoadError() {
      console.error('âŒ Office.js æœ¬åœ°æ–‡ä»¶åŠ è½½å¤±è´¥')
      const root = document.getElementById('root')
      if (root) {
        root.innerHTML = `
          <div style="padding: 20px; color: red; font-family: system-ui;">
            <h3>âš ï¸ Office.js åŠ è½½å¤±è´¥</h3>
            <p>æœ¬åœ° Office.js æ–‡ä»¶æœªæ‰¾åˆ°ï¼Œè¯·ç¡®ä¿ï¼š</p>
            <ul style="text-align: left; margin: 10px 0;">
              <li>å·²è¿è¡Œ <code>yarn dev</code> å¯åŠ¨å¼€å‘æœåŠ¡å™¨</li>
              <li>Vite é…ç½®æ­£ç¡®å¤åˆ¶äº† office.js æ–‡ä»¶</li>
              <li>åœ¨ Office åº”ç”¨ä¸­æ‰“å¼€æ­¤æ’ä»¶</li>
            </ul>
            <p style="font-size: 12px; color: #666;">å½“å‰è·¯å¾„: ${window.location.href}</p>
          </div>
        `
      }
    }
  </script>
</head>

<body>
  <div id="root">
    <div style="padding: 20px; text-align: center; color: #666;">
      <p>æ­£åœ¨åŠ è½½æ­¦æ±‰é—®æ´¥ AI åŠ©æ‰‹...</p>
      <p style="font-size: 12px;">å¦‚æœé•¿æ—¶é—´æœªåŠ è½½ï¼Œè¯·æŒ‰ F12 æŸ¥çœ‹æ§åˆ¶å°</p>
    </div>
  </div>
  <!-- Portal å®¹å™¨ï¼šç”¨äº Fluent UI çš„ Dropdown ç­‰ç»„ä»¶æ¸²æŸ“å¼¹å‡ºå±‚ -->
  <div id="portal-root"></div>
  <script type="module" src="./index.tsx"></script>
</body>

</html>
